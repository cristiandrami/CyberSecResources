
This CVE is based on a buffer overflow.

It afflicts `sudo` in the versions `<1.8.26`. It happens when in the file `/etc/sudoers` the `pwfeedback` is enabled...
- ![[Pasted image 20250116170237.png]]


We can notice that it is enabled when we put the password and we can see on the screen `***`:
- ![[Pasted image 20250116170316.png]]

<mark style="background: #FF5582A6;">The exploit inserts a long input in the password request generating a buffer overflow that allows the access to a `root` shell.</mark>

# test for it in tryhackme

We can try it using this room:
- [https://tryhackme.com/r/room/sudovulnsbof](https://tryhackme.com/r/room/sudovulnsbof)

First of all we connect in `ssh`:
```bash
ssh -p 4444 username@IP
```
- ![[Pasted image 20250116170510.png]]
- ![[Pasted image 20250116170527.png]]

If we try to run `sudo su` we can notice that the `pwfeedback` is enabled:
- ![[Pasted image 20250116170611.png]]


So we test for all the tests:
- ![[Pasted image 20250116170651.png]]

At this point we search for the version of sudo we are using:
```bash
sudo -V
```
- ![[Pasted image 20250116170726.png]]

So it is vulnerable to `CVE-2019-18634` 
# Using the exploit
We can find the exploit of the vulnerability here [https://github.com/saleemrashid/sudo-cve-2019-18634](https://github.com/saleemrashid/sudo-cve-2019-18634)


We just need to run it:
```
chmod +x exploit

./exploit
```
- ![[Pasted image 20250116171049.png]]

<mark style="background: #BBFABBA6;">We gain the root access!</mark>
