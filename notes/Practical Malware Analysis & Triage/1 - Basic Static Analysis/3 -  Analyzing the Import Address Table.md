
In this case we will use `PEview` in order to analyze the `Portable Executable` files of windows (`.exe`, `.dll`, `.sys` etc).

It is used to analyze the internal structure of the binary without executing it.

It allows us to inspect:
- `PE sections` (`.text`, `.data`, `.rdata`, `.rsrc`) and analyze suspect code
- `import` and `export` used for import malicious functions
- the entry point of the code to see if it is manipulated
- `PE metadata`



So we open it:
- ![[Pasted image 20250205120332.png]]
- we select `all files` and load our malware
- ![[Pasted image 20250205120420.png]]



We can notice at the beginning a `MZ`:
- ![[Pasted image 20250205120922.png]]
- this means we are analyzing a windows executable file


On the left we can see all the sections of the executable file:
- ![[Pasted image 20250205121040.png]]



Under `IMAGE_NT_HEADERS` -> `IMAGE_FILE_HEADER` we can see the `Time Date Stamp` that is the compilation date of the binary:
- ![[Pasted image 20250205121215.png]]
- sometimes it give information
- *for example malwares compiled with Borland Delphi (so malware written in delphi) have always a date of 1992*


Then we have the IMAGE sections:
- ![[Pasted image 20250205121510.png]]
- they are used at runtime to retrieve info 

In the `text` section we can find `Virtual size` and the `Size of Raw Data:
- ![[Pasted image 20250205121601.png]]
- ![[Pasted image 20250205121701.png]]
- we convert both in decimal and if they are pretty the same we can understand that when teh binary is run it uses only the data present into it
- if the `Size of raw data` is very lower than thje `Virtual size` it means that there is something we cannot see (**maybe the malware is a packed binary**)
	- this means there are hidden sections and content we cannot see without executing it


# Address table
If we visit the section `.rdata` we can see the also the `Address table ` of the imports:
- ![[Pasted image 20250205122109.png]]
- ![[Pasted image 20250205122120.png]]

Important here is `Win32.dll` that is the `Windows API` used to import system functions.
