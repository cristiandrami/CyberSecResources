Procmon is a software developed by microsoft used to monitor and analyse the behavior of a sotware at runtime.

We open it and we filter the criteria using the name of the malware:
- ![[Pasted image 20250206115746.png]]
- ![[Pasted image 20250206115758.png]]
- ![[Pasted image 20250206115838.png]]

Now we have no events, so we run the malware and we see:
- ![[Pasted image 20250206115926.png]]
- everything about the malware execution


Always in floss we have seen a system path:
- ![[Pasted image 20250206120146.png]]

So we search for it in the execution:
- ![[Pasted image 20250206120357.png]]
- ![[Pasted image 20250206120413.png]]

So we can see that the malware creates a file in `C:\Users\Public\Documents\CR433101.dat.exe`


## Checking the file creation

We go on `C:\Users\Public\Documents\`
- ![[Pasted image 20250206120557.png]]

If we remove it and we run another time the malware then it will create the file again...

This is part of the Host indicators

*It could be a downloader malware type, that downloads another malicious malware and stores it on the system.*

It could be:
- it requests for `favicon.ico` to a malicious domain
- it downloads a file called `CR433101.dat.exe`
	- or maybe they are not correlated

# Detail filter
At this point always using floss we have seen an interesting command execution:
- ![[Pasted image 20250206121330.png]]

So we search for it into detail filter
```
cmd.exe /C ping 1.1.1.1 -n 1 -w 3000 > Nul & Del /f /q "%s"
```

If we have `inetsim` open it is not exectuted, but if we stop `inetsim`:
- ![[Pasted image 20250206121823.png]]


So the malware:

If URL exists:
- download `favicon.ico` (`CR433101.dat.exe`) 
- run it (`CR433101.dat.exe`)

If URL doesn't exist:
- delete from disk
- don't run
