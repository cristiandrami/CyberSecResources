
In this section we will use:
- `PMAT-labs/labs/2-1.AdvancedStaticAnalysis/Dropper.DownloadFromURL.exe.malz/Dropper.DownloadFromURL.exe.7z`


To study it and disassemble and decompile it we will use the `cutter` tool.

# Using cutter
We will use the `Auto-Analysis` level:
- ![[Pasted image 20250207160248.png]]
- ![[Pasted image 20250207160318.png]]
- here we can see a lot of info about the `PE`, like the hashes and so on

Clicking on the left on a function (in this case `entry0`) we can see the assembly language:
- ![[Pasted image 20250207160425.png]]


In a program there is always a entry function from which the other functions are called. 
It's name is `main`:
- ![[Pasted image 20250207160549.png]]

Here we can see a lot of info:
- ![[Pasted image 20250207160646.png]]

One very useful tool is the graph.

# Functions graph
To se the function graph we can click on the bottom:
- ![[Pasted image 20250207160744.png]]

From here we can see we start from the `main` function and we have two possible calls:
- ![[Pasted image 20250207160914.png]]


We remember that 
1. if the malware is able to download the second part it will execute the other stuff
2. if it can't download from internet then it deletes itself from the disk


# decompiler
If we go on the decompiler, it will show us a reconstruction of the original code (not exactly the same):
- ![[Pasted image 20250207170453.png]]

