`x32Debug` is used to debug executable files. It is very useful to run the binaries step by step.


In this section we will use:
- `PMAT-labs/labs/2-2.AdvancedDynamicAnalysis/Dropper.DownloadFromURL/Dropper.DownloadFromURL.exe.7z`

# Run x32dbg
On the right we can see the memory registers:
- ![[Pasted image 20250210114010.png]]

On the left the execution flow:
- ![[Pasted image 20250210114036.png]]



With `F2` we can put a breakpoint on a single instruction.
We we put a breakpoint and run the binary, the exectuion will stop on the breakpoint.

First of all we need to run the program:
- ![[Pasted image 20250210115341.png]]
	- or just `F9`
- ![[Pasted image 20250210115410.png]]




Clicking on it:
- ![[Pasted image 20250210114817.png]]
- we will run a single instruction
- it works also with `F7`


At this point we put a breakpoint on the main malware function call:
- ![[Pasted image 20250210115737.png]]
- using `F2`

Each time we run the program now it wil stop on the breakpoint set.

# Instructions and API calls
So now we remove all breakpoints in the section `Breakpoints`:
- ![[Pasted image 20250210140733.png]]

Now we restart the program and run it:
- ![[Pasted image 20250210140853.png]]
- ![[Pasted image 20250210140907.png]]



At this point we use `F7` untill we reach an interesting point.
- we find the last call to download function and we put a breakpoint
- ![[Pasted image 20250210142134.png]]

At this point we click on follow in the disassembler:
- ![[Pasted image 20250210142206.png]]
- ![[Pasted image 20250210142638.png]]
- it seems to use API calls to connect on internet


Now we put a breakpooint on `push 0`:
- ![[Pasted image 20250210143118.png]]


If we open `Wireshark` we can understand that on the instruction `tex eax,eax` the malwaare does the requests to the malicious page to download the second stage:
- ![[Pasted image 20250210143410.png]]
- 