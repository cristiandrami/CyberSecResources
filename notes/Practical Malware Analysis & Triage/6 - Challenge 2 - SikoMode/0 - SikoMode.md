In this challenge we will study:
- `PMAT-labs/labs/2-3.Challenge-SikoMode/unknown.exe.7z`

# Hash calculation
First of all we need to calculate the `md5` and `sha256` hashes of the malware:
```powershell
sha256sum.exe unknown.exe.malz

md5sum.exe unknown.exe.malz
```

```text
md5:     
b9497ffb7e9c6f49823b95851ec874e3 

sha256: 3aca2a08cf296f1845d6171958ef0ffd1c8bdfc3e48bdd34a605cb1f7468213e
```

# Static analysis
## Floss for extracting strings
```powershell
floss.exe -n 6 unknown.exe.malz > floss.txt
```
- ![[Pasted image 20250210161127.png]]
- we can see it is written in `NIM`


## open PEview
We open it and we understand it is a `64 bit` executable:
- ![[Pasted image 20250210161321.png]]
- No other useful info in this tool


At this point we can notice in floss that `RC4` is used as encryption algorithm:
- ![[Pasted image 20250210164522.png]]


So we open CUTTER and we see what it does:
- ![[Pasted image 20250210164722.png]]
- ![[Pasted image 20250210164727.png]]


# Automatic analysis by PEstudio
At this point we can use `PEstudio` to have an overview about the executable file.
- ![[Pasted image 20250210161446.png]]
- There are some API calls generally used by malwares

In the strigns we can find interesting info:
- ![[Pasted image 20250210161545.png]]
- it seems to use Internet to perform some actions




# Dynamic analysis

# Process study
We can run `Procmon` to study it 

We use a filter on the `CreateFile`:
- ![[Pasted image 20250210165004.png]]
- ![[Pasted image 20250210165025.png]]

We can notice it creates a file called `passwrd.txt`

So let's take a look at it:
- ![[Pasted image 20250210165110.png]]
- it contains `SikoMode`

Now we will see on cutter the main function (in this case `MainModule`):
- ![[Pasted image 20250210165251.png]]
- ![[Pasted image 20250210165325.png]]

A funciton houdini is called after a `checkKillSwitchURL`, it could be the function that deletes the file from the disk if it cannot do the requests:
- this because it jumps to the end of the execution
- ![[Pasted image 20250210165732.png]]

In the other case it performs some other operations:
- ![[Pasted image 20250210165758.png]]


`stealStuff` seams interesting:
- 
# REMnux traffic analysis
Now we can run our `inetsim` on REMnux:
```bash
inetsim
```
- ![[Pasted image 20250210161709.png]]


## Wireshark analysis 
We open also wireshark on `REMnux`:
- ![[Pasted image 20250210162242.png]]
- on the `enp0s3` interface


At this point we run the malware on the `windows machine`:
- ![[Pasted image 20250210162330.png]]
- we can see some traffic


So we open the `HTTP` request and we copy the domain contianed in it:
- `http://update.ec12-4-109-278-3-ubuntu20-04.local/`

And we search for it in `floss`:
- no results

We now  see that there is another request `HTTP`:
- ![[Pasted image 20250210163729.png]]



